<div ui-grid="gridOptions" ui-grid-pagination ui-grid-cellNav class="myGrid" style="width:100%;float:left"></div>




<script>
    (function(scope){
        scope.gridOptions = {
            data: 'data.items',
            enableCellEditOnFocus: true,
            enableColumnResizing: true,
            enableFiltering: true,
            enableGridMenu: true,
            showGridFooter: true,
            showColumnFooter: true,
            fastWatch: true,
            paginationPageSizes: [25, 50, 75],
            paginationPageSize: 25,
            useExternalPagination: true,
            useExternalSorting: true,
            columnDefs: [
              { name: 'name' },
              { name: 'gender', enableSorting: false },
              { name: 'company', enableSorting: false }
            ],
            onRegisterApi: function(gridApi) {
              debugger;
              scope.gridApi = gridApi;
              scope.gridApi.core.on.sortChanged(scope, function(grid, sortColumns) {
                if (sortColumns.length == 0) {
                  paginationOptions.sort = null;
                } else {
                  paginationOptions.sort = sortColumns[0].sort.direction;
                }
                debugger;
                //getPage();
              });
              gridApi.pagination.on.paginationChanged(scope, function (newPage, pageSize) {
                paginationOptions.pageNumber = newPage;
                paginationOptions.pageSize = pageSize;
                debugger;
                //getPage();
              });
            }
          };
        scope.dialog_import_excel_url="${get_app_url('pages/dialogs/excel_import')}";
        scope.dialog_export_excel_url="${get_app_url('pages/dialogs/excel_export')}";
        scope.view_path="${get_view_path()}";
        services=ws(scope);
        scope.$root.onSearch(function(txt){
            scope.load_data(txt);
        })
        scope.load_data=function(txt){
            services.api("lv_admin.api.users/get_list")
                    .data({
                            search_text:txt,
                            page_size:50,
                            page_index:0,
                            sort:[]

                    }).done().then(function(res){
                        scope.data=res;
                        scope.gridOptions.data=res.items;
                        console.log(res);
                        scope.$applyAsync();
                    })

            /*ws_call("admin.api.users/get_list",{
                view:scope.view_path,
                data:{
                    search_text:txt
                }
            }).then(function(res){

            }).catch(function(ex){
                console.log(ex);
            })*/

        }
        scope.doDelete=function(item){
         console.log(item);
        }
        scope.load_data("");
        scope.get_url_export=function(subScope){
            subScope.getTitle=function(){
                return '${get_app_res("Xuất danh sách tài khoản ra Excel")}';
            };
            subScope.$applyAsync();
            subScope.url='${get_app_url("excel/download/users")}';
            console.log(subScope);
        };

    });
</script>
